{% block sw_cms_sidebar_page_settings %}
<sw-sidebar-item
    ref="blogConfigSidebar"
    icon="regular-info-circle"
    badge-type="error"
    :title="$tc('werkl-blog.detail.sidebar.heading')"
    :has-simple-badge="OpenBlogwareDetailError"
    :disabled="page.locked || disabled"
>
    {% block werkl_blog_cms_sidebar_page_basic_information %}
    <sw-sidebar-collapse :expand-on-loading="true">
        {% block werkl_blog_cms_sidebar_page_basic_information_header %}
        <template #header>
            <span>{{ $tc('werkl-blog.detail.sidebar.basicInformation') }}</span>
        </template>
        {% endblock %}

        {% block werkl_blog_cms_sidebar_page_basic_information_form %}
        <template #content>
            <div class="sw-cms-sidebar__settings">
                {% block werkl_blog_cms_sidebar_page_basic_information_title_field %}
                <mt-text-field
                    v-model="blog.title"
                    required
                    :label="$tc('werkl-blog.detail.titleLabel')"
                    :placeholder="$tc('werkl-blog.detail.titlePlaceholder')"
                    :error="blogTitleError"
                />
                {% endblock %}

                {% block werkl_blog_cms_sidebar_page_basic_information_slug_field %}
                <mt-text-field
                    v-model="blog.slug"
                    required
                    :label="$tc('werkl-blog.detail.slugLabel')"
                    :placeholder="$tc('werkl-blog.detail.slugPlaceholder')"
                    :error="blogSlugError"
                />
                {% endblock %}

                <div class="sw-field">
                    <span class="sw-field__label">URL</span>
                    <a
                        :href="`/blog/${blog.slug}`"
                        target="_blank"
                        class="werkl-blog-preview"
                    >
                        /blog/{{blog.slug}}
                    </a>
                </div>

                {% block werkl_blog_cms_sidebar_page_basic_information_teaser_field %}
                <mt-textarea
                    v-model="blog.teaser"
                    :label="$tc('werkl-blog.detail.teaserLabel')"
                    :placeholder="$tc('werkl-blog.detail.teaserPlaceholder')"
                    :error="blogTeaserError"
                />
                {% endblock %}

                {% block werkl_blog_cms_sidebar_page_basic_information_image_field %}
                <sw-upload-listener
                    :uploadTag="blog.id"
                    auto-upload
                    @media-upload-finish="onSetMediaItem"
                />

                <sw-media-compact-upload-v2
                    variant="regular"
                    :label="$tc('werkl-blog.detail.teaserImageLabel')"
                    :source="mediaItem"
                    :upload-tag="blog.id"
                    :default-folder="blog.getEntityName()"
                    :allow-multi-select="false"
                    :file-accept="fileAccept"
                    @media-upload-remove-image="onRemoveMediaItem"
                    @selection-change="setMedia"
                    @media-drop="onMediaDropped"
                />
                {% endblock %}
            </div>
        </template>
        {% endblock %}
    </sw-sidebar-collapse>
    {% endblock %}

    {% block werkl_blog_cms_sidebar_page_settings %}
    <sw-sidebar-collapse :expand-on-loading="true">
        {% block werkl_blog_cms_sidebar_page_settings_header %}
        <template #header>
            <span>{{ $tc('werkl-blog.detail.sidebar.settings') }}</span>
        </template>
        {% endblock %}

        {% block werkl_blog_cms_sidebar_page_settings_form %}
        <template #content>
            <div class="sw-cms-sidebar__settings">
                {% block werkl_blog_cms_sidebar_page_settings_visibility_field %}
                <mt-switch
                    v-model="blog.active"
                    class="werkl-field--switch"
                    :label="$tc('werkl-blog.detail.visibility.label')"
                />
                {% endblock %}

                {% block werkl_blog_cms_sidebar_page_settings_detail_teaser_field %}
                <mt-switch
                    v-model="blog.detailTeaserImage"
                    class="werkl-field--switch"
                    :label="$tc('werkl-blog.detail.detailTeaser.label')"
                />
                {% endblock %}

                {% block werkl_blog_cms_sidebar_page_settings_published_at_field %}
                <mt-datepicker
                    v-model="blog.publishedAt"
                    date-type="date"
                    required
                    class="werkl-field--published-at"
                    :label="$tc('werkl-blog.detail.publishedAtLabel')"
                    :error="blogPublishedAtError"
                />
                {% endblock %}

                {% block werkl_blog_cms_sidebar_page_settings_author_field %}
                <sw-entity-single-select
                    v-model:value="blog.authorId"
                    required
                    class="werkl-field--author"
                    entity="werkl_blog_author"
                    :label="$tc('werkl-blog.detail.author.label')"
                    :placeholder="$tc('werkl-blog.detail.author.placeholder')"
                    :error="blogAuthorIdError"
                >
                    <template #selection-label-property="{item}">
                        <span>{{ item.firstName }} {{ item.lastName }} <i>({{ item.email }})</i></span>
                    </template>

                    <template #result-label-property="{item}">
                        <span>{{ item.firstName }} {{ item.lastName }} <i>({{ item.email }})</i></span>
                    </template>
                </sw-entity-single-select>
                {% endblock %}

                {% block werkl_blog_cms_sidebar_page_settings_sales_channels %}
                <sw-entity-multi-id-select
                    v-model:value="blogSalesChannelIds"
                    :repository="salesChannelRepository"
                    class="werkl-field--sales-channels"
                    :label="$tc('werkl-blog.detail.salesChannels.labelSalesChannels')"
                    :placeholder="$tc('werkl-blog.detail.salesChannels.placeholderSalesChannels')"
                />
                {% endblock %}

                {% block werkl_blog_cms_sidebar_page_settings_category_field %}
                <werkl-blog-category-tree-field
                    v-model:value="blog.blogCategories"
                    :categories-collection="blog.blogCategories"
                    class="werkl-field--category"
                    required
                    :label="$tc('werkl-blog.detail.category.label')"
                    :placeholder="$tc('werkl-blog.detail.category.placeholder')"
                    :error="blogBlogCategoriesError"
                />
                {% endblock %}

                {% block werkl_blog_cms_sidebar_page_settings_tags %}
                <sw-entity-tag-select
                    v-if="blog && !isLoading"
                    v-model:entity-collection="blog.tags"
                    class="sw-blog-detail-base__tags"
                    :label="$tc('werkl-blog.detail.tagsLabel')"
                    :placeholder="$tc('werkl-blog.detail.tagsPlaceholder')"
                />
                {% endblock %}
            </div>
        </template>
        {% endblock %}
    </sw-sidebar-collapse>
    {% endblock %}

    {% block werkl_blog_cms_sidebar_page_serp %}
    <sw-sidebar-collapse :expand-on-loading="true">
        {% block werkl_blog_cms_sidebar_page_serp_header %}
        <template #header>
            <span>{{ $tc('werkl-blog.detail.serp.title') }}</span>
        </template>
        {% endblock %}

        {% block werkl_blog_cms_sidebar_page_serp_form %}
        <template #content>
            <div class="sw-cms-sidebar__settings serp-preview-card">
                <div class="serp-preview">
                    <h3>{{ blog.metaTitle }}</h3>
                    <cite>{{ blog.slug }}</cite>
                    <p>{{ blog.metaDescription }}</p>
                </div>

                {% block werkl_blog_cms_sidebar_page_serp_meta_title_field %}
                <mt-text-field
                    v-model="blog.metaTitle"
                    :max-length="maximumMetaTitleCharacter"
                    :placeholder="$tc('werkl-blog.detail.serp.metaTitle')"
                />
                {% endblock %}

                {% block werkl_blog_cms_sidebar_page_serp_meta_description_field %}
                <mt-textarea
                    v-model="blog.metaDescription"
                    :max-length="maximumMetaDescriptionCharacter"
                    :placeholder="$tc('werkl-blog.detail.serp.metaDescription')"
                />
                {% endblock %}
            </div>
        </template>
        {% endblock %}
    </sw-sidebar-collapse>
    {% endblock %}
</sw-sidebar-item>
{% endblock %}

{% block sw_cms_sidebar_layout_assignment %}
    {% block werkl_blog_cms_sidebar_extension_component %}
    <werkl-blog-extension-component-sections
        :position-identifier="positionIdentifierExtension"
        class="werkl-extension-component"
    >
        <template #default="{ componentSection }">
            <sw-sidebar-item
                v-if="componentSection"
                :icon="componentSection.props.icon"
                badge-type="error"
                :title="componentSection.props.title"
                :disabled="page.locked || disabled"
            >
                <sw-iframe-renderer
                    :src="componentSection.src"
                    :location-id="componentSection.props.locationId"
                />
            </sw-sidebar-item>
        </template>
    </werkl-blog-extension-component-sections>
    {% endblock %}
{% endblock %}
